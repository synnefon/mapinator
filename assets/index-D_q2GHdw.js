(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();const Ae={resolution:75,jitter:.5,wavelength:.4,rainfall:.6,seaLevel:.5,shatter:.1,edgeCurve:.8,greyScale:!1},xe=Math.sqrt(3),ve=.5*(xe-1),q=(3-xe)/6,ce=a=>Math.floor(a)|0,he=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function ue(a=Math.random){const e=Ee(a),t=new Float64Array(e).map(n=>he[n%12*2]),i=new Float64Array(e).map(n=>he[n%12*2+1]);return function(s,o){let l=0,r=0,h=0;const d=(s+o)*ve,c=ce(s+d),u=ce(o+d),f=(c+u)*q,m=c-f,g=u-f,p=s-m,_=o-g;let b,v;p>_?(b=1,v=0):(b=0,v=1);const E=p-b+q,M=_-v+q,T=p-1+2*q,k=_-1+2*q,C=c&255,y=u&255;let A=.5-p*p-_*_;if(A>=0){const S=C+e[y],R=t[S],L=i[S];A*=A,l=A*A*(R*p+L*_)}let w=.5-E*E-M*M;if(w>=0){const S=C+b+e[y+v],R=t[S],L=i[S];w*=w,r=w*w*(R*E+L*M)}let x=.5-T*T-k*k;if(x>=0){const S=C+1+e[y+1],R=t[S],L=i[S];x*=x,h=x*x*(R*T+L*k)}return 70*(l+r+h)}}function Ee(a){const t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){const n=i+~~(a()*(256-i)),s=t[i];t[i]=t[n],t[n]=s}for(let i=256;i<512;i++)t[i]=t[i-256];return t}function Y(a){let e=Se(a);return e===0&&(e=1831565813),function(){return e^=e<<13,e^=e>>>17,e^=e<<5,(e>>>0)%1e6/1e6}}function Se(a){let e=2166136261;for(let t=0;t<a.length;t++)e^=a.charCodeAt(t),e=Math.imul(e,16777619);return e>>>0}const P={OCEAN:{color:"#44447a",greyscale:"#000000",name:"ocean"},SUBTROPICAL_DESERT:{color:"#d2b98b",greyscale:"#2B2B2B",name:"subtropical desert"},GRASSLAND:{color:"#88aa55",greyscale:"#3F3F3F",name:"grassland"},TROPICAL_SEASONAL_FOREST:{color:"#559944",greyscale:"#4F4F4F",name:"tropical seasonal forest"},TROPICAL_RAIN_FOREST:{color:"#337755",greyscale:"#5F5F5F",name:"tropical rain forest"},TEMPERATE_DESERT:{color:"#c9d29b",greyscale:"#6A6A6A",name:"temperate desert"},DECIDUOUS_FOREST:{color:"#679459",greyscale:"#7A7A7A",name:"deciduous forest"},TEMPERATE_RAIN_FOREST:{color:"#448855",greyscale:"#8A8A8A",name:"rain forest"},SHRUBLAND:{color:"#889977",greyscale:"#AFAFAF",name:"shrubland"},TAIGA:{color:"#99aa77",greyscale:"#BFBFBF",name:"taiga"},BARREN_ROCK:{color:"#888888",greyscale:"#DADADA",name:"barren rock"},TUNDRA:{color:"#bbbbaa",greyscale:"#EAEAEA",name:"tundra"},GLACIER:{color:"#dddde4",greyscale:"#FFFFFF",name:"glacier"}},ie=[.6,1],se=[.4,.6],J=[.2,.4],Z=[0,.2],Ce=[-1,0],ee=[{elevation:ie,moisture:[0,.2],biome:P.BARREN_ROCK},{elevation:ie,moisture:[.2,.5],biome:P.TUNDRA},{elevation:ie,moisture:[.5,1],biome:P.GLACIER},{elevation:se,moisture:[0,.33],biome:P.TEMPERATE_DESERT},{elevation:se,moisture:[.33,.66],biome:P.SHRUBLAND},{elevation:se,moisture:[.66,1],biome:P.TAIGA},{elevation:J,moisture:[0,.16],biome:P.TEMPERATE_DESERT},{elevation:J,moisture:[.16,.5],biome:P.GRASSLAND},{elevation:J,moisture:[.5,.83],biome:P.DECIDUOUS_FOREST},{elevation:J,moisture:[.83,1],biome:P.TEMPERATE_RAIN_FOREST},{elevation:Z,moisture:[0,.16],biome:P.SUBTROPICAL_DESERT},{elevation:Z,moisture:[.16,.33],biome:P.GRASSLAND},{elevation:Z,moisture:[.33,.66],biome:P.TROPICAL_SEASONAL_FOREST},{elevation:Z,moisture:[.66,1],biome:P.TROPICAL_RAIN_FOREST},{elevation:Ce,moisture:[0,1],biome:P.OCEAN}];class Ie{rainfall;seaLevel;constructor(e,t){if(e<0||e>1||t<0||t>1)throw Error("rainfall & seaLevel must be 0-1");e=this.expCurve(1-e,4.1),this.rainfall=Math.max(.01,e*25),this.seaLevel=2*(t-.5)}getBiome(e,t){let i=2*(e-.5)-(this.seaLevel-.1),n=t**this.rainfall;i=Math.max(Math.min(i,1-this.EPS),-1),n=Math.max(Math.min(n,1-this.EPS),-1);const s=this.findMatchingBiomeRule(i,n);if(!s)throw new Error(`unable to find biome for elevation: ${e}, moisture: ${t}`);return s.biome}findMatchingBiomeRule(e,t){const i=this.findLastIndex(ee,(n,s,o)=>this.matchesRule(n,e,t));return ee[i]}isOcean(e){const t=this.findLastIndex(ee,n=>n.biome.name===P.OCEAN.name);return ee[t].elevation[1]>=e}expCurve(e,t){const i=Math.max(0,Math.min(1,e));return(Math.exp(t*i)-1)/(Math.exp(t)-1)}matchesRule(e,t,i){return e.elevation[0]<=t&&e.elevation[1]>t&&e.moisture[0]<=i&&e.moisture[1]>i}EPS=1e-9;findLastIndex(e,t){for(let i=e.length-1;i>=0;i--)if(t(e[i],i,e))return i;return-1}}const z=11102230246251565e-32,D=134217729,Me=(3+8*z)*z;function oe(a,e,t,i,n){let s,o,l,r,h=e[0],d=i[0],c=0,u=0;d>h==d>-h?(s=h,h=e[++c]):(s=d,d=i[++u]);let f=0;if(c<a&&u<t)for(d>h==d>-h?(o=h+s,l=s-(o-h),h=e[++c]):(o=d+s,l=s-(o-d),d=i[++u]),s=o,l!==0&&(n[f++]=l);c<a&&u<t;)d>h==d>-h?(o=s+h,r=o-s,l=s-(o-r)+(h-r),h=e[++c]):(o=s+d,r=o-s,l=s-(o-r)+(d-r),d=i[++u]),s=o,l!==0&&(n[f++]=l);for(;c<a;)o=s+h,r=o-s,l=s-(o-r)+(h-r),h=e[++c],s=o,l!==0&&(n[f++]=l);for(;u<t;)o=s+d,r=o-s,l=s-(o-r)+(d-r),d=i[++u],s=o,l!==0&&(n[f++]=l);return(s!==0||f===0)&&(n[f++]=s),f}function Te(a,e){let t=e[0];for(let i=1;i<a;i++)t+=e[i];return t}function Q(a){return new Float64Array(a)}const ke=(3+16*z)*z,Re=(2+12*z)*z,Le=(9+64*z)*z*z,V=Q(4),fe=Q(8),de=Q(12),ge=Q(16),j=Q(4);function Ne(a,e,t,i,n,s,o){let l,r,h,d,c,u,f,m,g,p,_,b,v,E,M,T,k,C;const y=a-n,A=t-n,w=e-s,x=i-s;E=y*x,u=D*y,f=u-(u-y),m=y-f,u=D*x,g=u-(u-x),p=x-g,M=m*p-(E-f*g-m*g-f*p),T=w*A,u=D*w,f=u-(u-w),m=w-f,u=D*A,g=u-(u-A),p=A-g,k=m*p-(T-f*g-m*g-f*p),_=M-k,c=M-_,V[0]=M-(_+c)+(c-k),b=E+_,c=b-E,v=E-(b-c)+(_-c),_=v-T,c=v-_,V[1]=v-(_+c)+(c-T),C=b+_,c=C-b,V[2]=b-(C-c)+(_-c),V[3]=C;let S=Te(4,V),R=Re*o;if(S>=R||-S>=R||(c=a-y,l=a-(y+c)+(c-n),c=t-A,h=t-(A+c)+(c-n),c=e-w,r=e-(w+c)+(c-s),c=i-x,d=i-(x+c)+(c-s),l===0&&r===0&&h===0&&d===0)||(R=Le*o+Me*Math.abs(S),S+=y*d+x*l-(w*h+A*r),S>=R||-S>=R))return S;E=l*x,u=D*l,f=u-(u-l),m=l-f,u=D*x,g=u-(u-x),p=x-g,M=m*p-(E-f*g-m*g-f*p),T=r*A,u=D*r,f=u-(u-r),m=r-f,u=D*A,g=u-(u-A),p=A-g,k=m*p-(T-f*g-m*g-f*p),_=M-k,c=M-_,j[0]=M-(_+c)+(c-k),b=E+_,c=b-E,v=E-(b-c)+(_-c),_=v-T,c=v-_,j[1]=v-(_+c)+(c-T),C=b+_,c=C-b,j[2]=b-(C-c)+(_-c),j[3]=C;const L=oe(4,V,4,j,fe);E=y*d,u=D*y,f=u-(u-y),m=y-f,u=D*d,g=u-(u-d),p=d-g,M=m*p-(E-f*g-m*g-f*p),T=w*h,u=D*w,f=u-(u-w),m=w-f,u=D*h,g=u-(u-h),p=h-g,k=m*p-(T-f*g-m*g-f*p),_=M-k,c=M-_,j[0]=M-(_+c)+(c-k),b=E+_,c=b-E,v=E-(b-c)+(_-c),_=v-T,c=v-_,j[1]=v-(_+c)+(c-T),C=b+_,c=C-b,j[2]=b-(C-c)+(_-c),j[3]=C;const I=oe(L,fe,4,j,de);E=l*d,u=D*l,f=u-(u-l),m=l-f,u=D*d,g=u-(u-d),p=d-g,M=m*p-(E-f*g-m*g-f*p),T=r*h,u=D*r,f=u-(u-r),m=r-f,u=D*h,g=u-(u-h),p=h-g,k=m*p-(T-f*g-m*g-f*p),_=M-k,c=M-_,j[0]=M-(_+c)+(c-k),b=E+_,c=b-E,v=E-(b-c)+(_-c),_=v-T,c=v-_,j[1]=v-(_+c)+(c-T),C=b+_,c=C-b,j[2]=b-(C-c)+(_-c),j[3]=C;const N=oe(I,de,4,j,ge);return ge[N-1]}function te(a,e,t,i,n,s){const o=(e-s)*(t-n),l=(a-n)*(i-s),r=o-l,h=Math.abs(o+l);return Math.abs(r)>=ke*h?r:-Ne(a,e,t,i,n,s,h)}const me=Math.pow(2,-52),ne=new Uint32Array(512);class X{static from(e,t=je,i=Be){const n=e.length,s=new Float64Array(n*2);for(let o=0;o<n;o++){const l=e[o];s[2*o]=t(l),s[2*o+1]=i(l)}return new X(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*t-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:i,_hullTri:n,_hullHash:s}=this,o=e.length>>1;let l=1/0,r=1/0,h=-1/0,d=-1/0;for(let y=0;y<o;y++){const A=e[2*y],w=e[2*y+1];A<l&&(l=A),w<r&&(r=w),A>h&&(h=A),w>d&&(d=w),this._ids[y]=y}const c=(l+h)/2,u=(r+d)/2;let f,m,g;for(let y=0,A=1/0;y<o;y++){const w=le(c,u,e[2*y],e[2*y+1]);w<A&&(f=y,A=w)}const p=e[2*f],_=e[2*f+1];for(let y=0,A=1/0;y<o;y++){if(y===f)continue;const w=le(p,_,e[2*y],e[2*y+1]);w<A&&w>0&&(m=y,A=w)}let b=e[2*m],v=e[2*m+1],E=1/0;for(let y=0;y<o;y++){if(y===f||y===m)continue;const A=De(p,_,b,v,e[2*y],e[2*y+1]);A<E&&(g=y,E=A)}let M=e[2*g],T=e[2*g+1];if(E===1/0){for(let w=0;w<o;w++)this._dists[w]=e[2*w]-e[0]||e[2*w+1]-e[1];K(this._ids,this._dists,0,o-1);const y=new Uint32Array(o);let A=0;for(let w=0,x=-1/0;w<o;w++){const S=this._ids[w],R=this._dists[S];R>x&&(y[A++]=S,x=R)}this.hull=y.subarray(0,A),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(te(p,_,b,v,M,T)<0){const y=m,A=b,w=v;m=g,b=M,v=T,g=y,M=A,T=w}const k=Pe(p,_,b,v,M,T);this._cx=k.x,this._cy=k.y;for(let y=0;y<o;y++)this._dists[y]=le(e[2*y],e[2*y+1],k.x,k.y);K(this._ids,this._dists,0,o-1),this._hullStart=f;let C=3;i[f]=t[g]=m,i[m]=t[f]=g,i[g]=t[m]=f,n[f]=0,n[m]=1,n[g]=2,s.fill(-1),s[this._hashKey(p,_)]=f,s[this._hashKey(b,v)]=m,s[this._hashKey(M,T)]=g,this.trianglesLen=0,this._addTriangle(f,m,g,-1,-1,-1);for(let y=0,A,w;y<this._ids.length;y++){const x=this._ids[y],S=e[2*x],R=e[2*x+1];if(y>0&&Math.abs(S-A)<=me&&Math.abs(R-w)<=me||(A=S,w=R,x===f||x===m||x===g))continue;let L=0;for(let $=0,we=this._hashKey(S,R);$<this._hashSize&&(L=s[(we+$)%this._hashSize],!(L!==-1&&L!==i[L]));$++);L=t[L];let I=L,N;for(;N=i[I],te(S,R,e[2*I],e[2*I+1],e[2*N],e[2*N+1])>=0;)if(I=N,I===L){I=-1;break}if(I===-1)continue;let B=this._addTriangle(I,x,i[I],-1,-1,n[I]);n[x]=this._legalize(B+2),n[I]=B,C++;let O=i[I];for(;N=i[O],te(S,R,e[2*O],e[2*O+1],e[2*N],e[2*N+1])<0;)B=this._addTriangle(O,x,N,n[x],-1,n[O]),n[x]=this._legalize(B+2),i[O]=O,C--,O=N;if(I===L)for(;N=t[I],te(S,R,e[2*N],e[2*N+1],e[2*I],e[2*I+1])<0;)B=this._addTriangle(N,x,I,-1,n[I],n[N]),this._legalize(B+2),n[N]=B,i[I]=I,C--,I=N;this._hullStart=t[x]=I,i[I]=t[O]=x,i[x]=O,s[this._hashKey(S,R)]=x,s[this._hashKey(e[2*I],e[2*I+1])]=I}this.hull=new Uint32Array(C);for(let y=0,A=this._hullStart;y<C;y++)this.hull[y]=A,A=i[A];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(Fe(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:i,coords:n}=this;let s=0,o=0;for(;;){const l=i[e],r=e-e%3;if(o=r+(e+2)%3,l===-1){if(s===0)break;e=ne[--s];continue}const h=l-l%3,d=r+(e+1)%3,c=h+(l+2)%3,u=t[o],f=t[e],m=t[d],g=t[c];if(Oe(n[2*u],n[2*u+1],n[2*f],n[2*f+1],n[2*m],n[2*m+1],n[2*g],n[2*g+1])){t[e]=g,t[l]=u;const _=i[c];if(_===-1){let v=this._hullStart;do{if(this._hullTri[v]===c){this._hullTri[v]=e;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(e,_),this._link(l,i[o]),this._link(o,c);const b=h+(l+1)%3;s<ne.length&&(ne[s++]=b)}else{if(s===0)break;e=ne[--s]}}return o}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,i,n,s,o){const l=this.trianglesLen;return this._triangles[l]=e,this._triangles[l+1]=t,this._triangles[l+2]=i,this._link(l,n),this._link(l+1,s),this._link(l+2,o),this.trianglesLen+=3,l}}function Fe(a,e){const t=a/(Math.abs(a)+Math.abs(e));return(e>0?3-t:1+t)/4}function le(a,e,t,i){const n=a-t,s=e-i;return n*n+s*s}function Oe(a,e,t,i,n,s,o,l){const r=a-o,h=e-l,d=t-o,c=i-l,u=n-o,f=s-l,m=r*r+h*h,g=d*d+c*c,p=u*u+f*f;return r*(c*p-g*f)-h*(d*p-g*u)+m*(d*f-c*u)<0}function De(a,e,t,i,n,s){const o=t-a,l=i-e,r=n-a,h=s-e,d=o*o+l*l,c=r*r+h*h,u=.5/(o*h-l*r),f=(h*d-l*c)*u,m=(o*c-r*d)*u;return f*f+m*m}function Pe(a,e,t,i,n,s){const o=t-a,l=i-e,r=n-a,h=s-e,d=o*o+l*l,c=r*r+h*h,u=.5/(o*h-l*r),f=a+(h*d-l*c)*u,m=e+(o*c-r*d)*u;return{x:f,y:m}}function K(a,e,t,i){if(i-t<=20)for(let n=t+1;n<=i;n++){const s=a[n],o=e[s];let l=n-1;for(;l>=t&&e[a[l]]>o;)a[l+1]=a[l--];a[l+1]=s}else{const n=t+i>>1;let s=t+1,o=i;W(a,n,s),e[a[t]]>e[a[i]]&&W(a,t,i),e[a[s]]>e[a[i]]&&W(a,s,i),e[a[t]]>e[a[s]]&&W(a,t,s);const l=a[s],r=e[l];for(;;){do s++;while(e[a[s]]<r);do o--;while(e[a[o]]>r);if(o<s)break;W(a,s,o)}a[t+1]=a[o],a[o]=l,i-s+1>=o-t?(K(a,e,s,i),K(a,e,t,o-1)):(K(a,e,t,o-1),K(a,e,s,i))}}function W(a,e,t){const i=a[e];a[e]=a[t],a[t]=i}function je(a){return a[0]}function Be(a){return a[1]}class _e{rng;constructor(e){this.rng=Y(e)}genPoints(e){this.rng=Y(`seed-${e.resolution}`);const{resolution:t,jitter:i}=e,n=this.initPoints(t,i),{centers:s,delaunay:o}=this.relaxPoints(n,4);return{centers:s,delaunay:o}}nextHalfedge(e){return e%3===2?e-2:e+1}triOfEdge(e){return Math.floor(e/3)}buildInedges(e,t){const i=new Int32Array(t).fill(-1),{triangles:n}=e;for(let s=0;s<n.length;s++)i[n[s]]=s;return i}halfedgesAroundSite(e,t,i){const{triangles:n,halfedges:s}=e;let o=t[i];if(o===-1)return null;const l=[];let r=o;do{l.push(r);const h=this.nextHalfedge(r),d=s[h];if(d===-1)return null;r=d,n[r]!==i&&(r=this.nextHalfedge(r),n[r]!==i&&(r=this.nextHalfedge(r)))}while(r!==o);return l}circumcenterOfTri(e,t,i){const{triangles:n}=i,s=e[n[3*t+0]],o=e[n[3*t+1]],l=e[n[3*t+2]],r=s.x*s.x+s.y*s.y,h=o.x*o.x+o.y*o.y,d=l.x*l.x+l.y*l.y,c=2*(s.x*(o.y-l.y)+o.x*(l.y-s.y)+l.x*(s.y-o.y));if(Math.abs(c)<1e-12)return{x:(s.x+o.x+l.x)/3,y:(s.y+o.y+l.y)/3};const u=(r*(o.y-l.y)+h*(l.y-s.y)+d*(s.y-o.y))/c,f=(r*(l.x-o.x)+h*(s.x-l.x)+d*(o.x-s.x))/c;return{x:u,y:f}}polygonCentroid(e,t){let i=0,n=0,s=0;const o=e.length;for(let r=0,h=o-1;r<o;h=r++){const d=e[r].x,c=e[r].y,u=e[h].x,f=e[h].y,m=u*c-d*f;i+=m,n+=(u+d)*m,s+=(f+c)*m}if(Math.abs(i)<1e-12)return t;const l=i/2;return{x:n/(6*l),y:s/(6*l)}}relaxOnce(e){const t=X.from(e,s=>s.x,s=>s.y),i=this.buildInedges(t,e.length),n=new Array(e.length);for(let s=0;s<e.length;s++){const o=this.halfedgesAroundSite(t,i,s);if(!o){n[s]=e[s];continue}const l=o.map(r=>this.circumcenterOfTri(e,this.triOfEdge(r),t));n[s]=this.polygonCentroid(l,e[s])}return{centers:n,delaunay:t}}relaxPoints(e,t){let i=e,n;for(let s=0;s<t;s++){const{centers:o,delaunay:l}=this.relaxOnce(i);i=o,n=l}if(!n)throw new Error("iterations wrong");return{centers:i,delaunay:n}}initPoints(e,t){const i=[];for(let n=0;n<e;n++)for(let s=0;s<e;s++){const o=n+t*(this.rng()-this.rng()),l=s+t*(this.rng()-this.rng());i.push({x:o,y:l})}return i}}class Ue{noise2D;pointGenerator;constructor(e){this.noise2D=ue(Y(e)),this.pointGenerator=new _e(e)}reSeed(e){this.noise2D=ue(Y(e)),this.pointGenerator=new _e(e)}generateMap(e){const{resolution:t}=e,{centers:i,delaunay:n}=this.pointGenerator.genPoints(e),s={points:i,resolution:t,numRegions:i.length,numTriangles:n.halfedges.length/3,numEdges:n.halfedges.length,halfedges:n.halfedges,triangles:n.triangles},o=this.genElevations(s,e),l=this.genMoistures(s,e),r=this.calcBiomes(s,o,l,e);return{...s,elevations:o,moistures:l,biomes:r}}calcBiomes(e,t,i,n){const{numRegions:s}=e,o=new Ie(n.rainfall,n.seaLevel),l=[];for(let r=0;r<s;r++)l.push(o.getBiome(t[r],i[r]));return l}genMoistures(e,t){const{wavelength:i}=t,{points:n,numRegions:s}=e;let o=[];for(let l=0;l<s;l++){const r=n[l].x/e.resolution-.5,h=n[l].y/e.resolution-1/2,d=(1+this.noise2D(r/i,h/i))/2;o[l]=Math.max(0,Math.min(1,d))}return o}genElevations(e,t){const{wavelength:i,edgeCurve:n}=t,s=1-t.shatter,o=.5,r=o+(3-o)*n,{points:h,numRegions:d,resolution:c}=e,u=new Array(d),f=g=>g<0?0:g>1?1:g,m=(g,p,_)=>g+(p-g)*_;for(let g=0;g<d;g++){const p=h[g].x/c-.5,_=h[g].y/c-.5;let b=1/3+this.noise2D(p/i,_/i)/2+this.noise2D(2*p/i,2*_/i)/3,v=2*Math.max(Math.abs(p),Math.abs(_));v=Math.pow(v,r);const E=(1+b-v)/2;b=m(b,E,f(s)),u[g]=f(b)}return u}}var U=(a=>(a.ROMANCE="romance",a.GERMANIC="germanic",a.SLAVIC="slavic",a.TURKIC="turkic",a.SEMITIC="semitic",a.BANTU_LIKE="bantu_like",a.AFRICAN_WEST="african_west",a.AFRICAN_HORN="african_horn",a.EAST_ASIAN_CN="east_asian_cn",a.EAST_ASIAN_JP="east_asian_jp",a.EAST_ASIAN_KR="east_asian_kr",a.POLYNESIAN="polynesian",a))(U||{});const ye=["a","e","i","o","u"],ze=["ai","au","ei","ia","io","oa","ue","ui"],Ge=["a","e","i","o","u","ia","io","ie","ea"],$e=["a","i","u","aa","ii","uu","ai","au"],pe={romance:{onsets:["b","c","d","f","g","l","m","n","p","r","s","t","br","cr","dr","fl","gl","gr","pr","tr","vr"],vowels:[...Ge,"oa","ue","eo"],codas:["n","r","s","l","m"],codaChance:.45,medials:["del","dor","ver","mar","val","lor","ria","lia","mia"],medialMorphChance:.35,suffixes:["ia","aria","esia"]},germanic:{onsets:["b","d","f","g","h","k","l","m","n","p","r","s","t","w","th","br","cr","dr","fr","gr","kr","pr","tr","st","sk","sp"],vowels:[...ye,...ze],codas:["nd","rt","rm","rg","lf","rk","lt","st","sk","n","r","m","l","k"],codaChance:.65,medials:["wald","heim","mark","gard","dorf"],medialMorphChance:.3,suffixes:["land","heim","berg"]},slavic:{onsets:["b","v","g","d","z","k","l","m","n","p","r","s","t","br","cr","dr","gr","kr","pr","tr","vl","vr","zv","zl","sk","sp","sl","sm","sn","pl","kl","gl","brn"],vowels:[...ye,"ya","yo","yu","ia","ie","io"],codas:["v","n","r","nsk","grad","gor","pol","mir","slav","sk"],codaChance:.7,medials:["grad","slav","pol","gor"],medialMorphChance:.4,suffixes:["ia","ovia","grad"]},semitic:{onsets:["al","ar","as","bal","dar","qal","mal","ram","sam","zar","bar","sar"],vowels:[...$e],codas:["n","m","r","l","s","h"],codaChance:.5,medials:["har","sar","ram","bar"],medialMorphChance:.35,suffixes:["ia","aya","iyya"]},african_west:{onsets:["a","ba","da","ka","fa","ga","la","ma","na","oba","ola","ade","kw","gb","ch","ny","eke","oba","ife","olu"],vowels:["a","e","i","o","u","ai","oa","ie","ua"],codas:["n","m","wa","ra",""],codaChance:.35,medials:["loba","femi","kwe","tunde","chukwu","nwa","kofi","yemi"],medialMorphChance:.4,suffixes:["la","ba","ra","ni","do","ma"]},african_horn:{onsets:["ab","ad","as","ba","da","ha","ka","ma","na","sa","ra","ta","gez","tes","hab","sel","mer","zer","yon","lem"],vowels:["a","e","i","o","u","aa","ee","ei","ia","ua"],codas:["s","m","n","l","t",""],codaChance:.45,medials:["sel","geb","tek","yon","hab","mar","zer","wold"],medialMorphChance:.35,suffixes:["el","es","os","on","u"]},east_asian_cn:{onsets:["b","p","m","f","d","t","n","l","g","k","h","zh","ch","sh","r","z","c","s"],vowels:["a","o","e","i","u","ü","ai","ei","ao","ou","ia","ie","iao","iu","ua","uo","ui","üe","er"],codas:["n","ng",""],codaChance:.4,medials:["shan","jiang","he","hu","zhou","dao","lin","yang","qing","jing","guo","cheng"],medialMorphChance:.3,suffixes:["shan","dao","zhou","guo","cheng","men"]},east_asian_jp:{onsets:["k","s","t","n","h","m","y","r","w","g","z","d","b","p","ky","sh","ch","ny","hy","my","ry","gy","j","py"],vowels:["a","i","u","e","o"],codas:["","n"],codaChance:.35,medials:["mori","yama","kawa","gawa","shima","jima","saka","hara","tani"],medialMorphChance:.3,suffixes:["to","ken","do","fu","shi","mura"]},east_asian_kr:{onsets:["g","n","d","r","m","b","s","j","ch","k","t","p","h"],vowels:["a","eo","o","u","eu","i","ae","e","ya","yeo","yo","yu","wa","we","wi","ui"],codas:["k","n","t","l","m","p","ng",""],codaChance:.45,medials:["san","seong","gang","cheon","buk","nam","jin","dae","won","do"],medialMorphChance:.35,suffixes:["do","si","gun","eup","ri"]},polynesian:{onsets:["","h","k","l","m","n","p","r","t","w","wh","ng"],vowels:["a","e","i","o","u"],codas:["","’","ʻ"],codaChance:.2,medials:["moa","rangi","tonga","tai","wai","puna","tapu","mana","ariki","tiki","honu","pua","mata","ika","koro","hale","fale","nui","loa","roa"],medialMorphChance:.3,suffixes:["nui","roa","loa","rangi","moana","tonga","tai","puna"]}};class Ve{rng;constructor(e){this.rng=Y(e)}reSeed(e){this.rng=Y(e)}generate(e={}){const t=e.lang??this.pickLanguage(),[i,n]=e.syllables??[1,2],s=this.randInt(i,n),o=(e.forceSuffix??this.pickSuffix(t)).toLowerCase();let l=this.buildStem(s,t);return l=this.tidyStemVsSuffix(l,o),this.titleCase(l+o)}pickLanguage(){const e=[U.ROMANCE,U.GERMANIC,U.SLAVIC,U.SEMITIC,U.EAST_ASIAN_CN,U.EAST_ASIAN_JP,U.EAST_ASIAN_KR,U.AFRICAN_WEST,U.AFRICAN_HORN,U.POLYNESIAN];return e[Math.floor(this.rng()*e.length)]}pickSuffix(e){const t=pe[e].suffixes;return t[Math.floor(this.rng()*t.length)]}buildStem(e,t){const i=pe[t];let n="";for(let s=0;s<e;s++)n+=this.pick(i.onsets)+this.pick(i.vowels),this.rng()<i.codaChance&&(n+=this.pick(i.codas));return n}tidyStemVsSuffix(e,t){return/[aeiou]$/i.test(e)&&/^[aeiou]/i.test(t)?e.slice(0,-1):e}titleCase(e){return e.charAt(0).toUpperCase()+e.slice(1)}pick(e){return e[Math.floor(this.rng()*e.length)]}randInt(e,t){return Math.floor(this.rng()*(t-e+1))+e}}const be=1e-6;class G{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,i){e=+e,t=+t,i=+i;const n=e+i,s=t;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${n},${s}`:(Math.abs(this._x1-n)>be||Math.abs(this._y1-s)>be)&&(this._+="L"+n+","+s),i&&(this._+=`A${i},${i},0,1,1,${e-i},${t}A${i},${i},0,1,1,${this._x1=n},${this._y1=s}`)}rect(e,t,i,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+i}v${+n}h${-i}Z`}value(){return this._||null}}class re{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class He{constructor(e,[t,i,n,s]=[0,0,960,500]){if(!((n=+n)>=(t=+t))||!((s=+s)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=n,this.xmin=t,this.ymax=s,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:i},vectors:n}=this;let s,o;const l=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let g=0,p=0,_=i.length,b,v;g<_;g+=3,p+=2){const E=i[g]*2,M=i[g+1]*2,T=i[g+2]*2,k=e[E],C=e[E+1],y=e[M],A=e[M+1],w=e[T],x=e[T+1],S=y-k,R=A-C,L=w-k,I=x-C,N=(S*I-R*L)*2;if(Math.abs(N)<1e-9){if(s===void 0){s=o=0;for(const O of t)s+=e[O*2],o+=e[O*2+1];s/=t.length,o/=t.length}const B=1e9*Math.sign((s-k)*I-(o-C)*L);b=(k+w)/2-B*I,v=(C+x)/2+B*L}else{const B=1/N,O=S*S+R*R,$=L*L+I*I;b=k+(I*O-R*$)*B,v=C+(S*$-L*O)*B}l[p]=b,l[p+1]=v}let r=t[t.length-1],h,d=r*4,c,u=e[2*r],f,m=e[2*r+1];n.fill(0);for(let g=0;g<t.length;++g)r=t[g],h=d,c=u,f=m,d=r*4,u=e[2*r],m=e[2*r+1],n[h+2]=n[d]=f-m,n[h+3]=n[d+1]=u-c}render(e){const t=e==null?e=new G:void 0,{delaunay:{halfedges:i,inedges:n,hull:s},circumcenters:o,vectors:l}=this;if(s.length<=1)return null;for(let d=0,c=i.length;d<c;++d){const u=i[d];if(u<d)continue;const f=Math.floor(d/3)*2,m=Math.floor(u/3)*2,g=o[f],p=o[f+1],_=o[m],b=o[m+1];this._renderSegment(g,p,_,b,e)}let r,h=s[s.length-1];for(let d=0;d<s.length;++d){r=h,h=s[d];const c=Math.floor(n[h]/3)*2,u=o[c],f=o[c+1],m=r*4,g=this._project(u,f,l[m+2],l[m+3]);g&&this._renderSegment(u,f,g[0],g[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new G:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const i=t==null?t=new G:void 0,n=this._clip(e);if(n===null||!n.length)return;t.moveTo(n[0],n[1]);let s=n.length;for(;n[0]===n[s-2]&&n[1]===n[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(n[o]!==n[o-2]||n[o+1]!==n[o-1])&&t.lineTo(n[o],n[o+1]);return t.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,i=e.length/2;t<i;++t){const n=this.cellPolygon(t);n&&(n.index=t,yield n)}}cellPolygon(e){const t=new re;return this.renderCell(e,t),t.value()}_renderSegment(e,t,i,n,s){let o;const l=this._regioncode(e,t),r=this._regioncode(i,n);l===0&&r===0?(s.moveTo(e,t),s.lineTo(i,n)):(o=this._clipSegment(e,t,i,n,l,r))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,t,i){return t=+t,t!==t||(i=+i,i!==i)?!1:this.delaunay._step(e,t,i)===e}*neighbors(e){const t=this._clip(e);if(t)for(const i of this.delaunay.neighbors(e)){const n=this._clip(i);if(n){e:for(let s=0,o=t.length;s<o;s+=2)for(let l=0,r=n.length;l<r;l+=2)if(t[s]===n[l]&&t[s+1]===n[l+1]&&t[(s+2)%o]===n[(l+r-2)%r]&&t[(s+3)%o]===n[(l+r-1)%r]){yield i;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:i,halfedges:n,triangles:s}}=this,o=i[e];if(o===-1)return null;const l=[];let r=o;do{const h=Math.floor(r/3);if(l.push(t[h*2],t[h*2+1]),r=r%3===2?r-2:r+1,s[r]!==e)break;r=n[r]}while(r!==o&&r!==-1);return l}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:i}=this,n=e*4;return this._simplify(i[n]||i[n+1]?this._clipInfinite(e,t,i[n],i[n+1],i[n+2],i[n+3]):this._clipFinite(e,t))}_clipFinite(e,t){const i=t.length;let n=null,s,o,l=t[i-2],r=t[i-1],h,d=this._regioncode(l,r),c,u=0;for(let f=0;f<i;f+=2)if(s=l,o=r,l=t[f],r=t[f+1],h=d,d=this._regioncode(l,r),h===0&&d===0)c=u,u=0,n?n.push(l,r):n=[l,r];else{let m,g,p,_,b;if(h===0){if((m=this._clipSegment(s,o,l,r,h,d))===null)continue;[g,p,_,b]=m}else{if((m=this._clipSegment(l,r,s,o,d,h))===null)continue;[_,b,g,p]=m,c=u,u=this._edgecode(g,p),c&&u&&this._edge(e,c,u,n,n.length),n?n.push(g,p):n=[g,p]}c=u,u=this._edgecode(_,b),c&&u&&this._edge(e,c,u,n,n.length),n?n.push(_,b):n=[_,b]}if(n)c=u,u=this._edgecode(n[0],n[1]),c&&u&&this._edge(e,c,u,n,n.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return n}_clipSegment(e,t,i,n,s,o){const l=s<o;for(l&&([e,t,i,n,s,o]=[i,n,e,t,o,s]);;){if(s===0&&o===0)return l?[i,n,e,t]:[e,t,i,n];if(s&o)return null;let r,h,d=s||o;d&8?(r=e+(i-e)*(this.ymax-t)/(n-t),h=this.ymax):d&4?(r=e+(i-e)*(this.ymin-t)/(n-t),h=this.ymin):d&2?(h=t+(n-t)*(this.xmax-e)/(i-e),r=this.xmax):(h=t+(n-t)*(this.xmin-e)/(i-e),r=this.xmin),s?(e=r,t=h,s=this._regioncode(e,t)):(i=r,n=h,o=this._regioncode(i,n))}}_clipInfinite(e,t,i,n,s,o){let l=Array.from(t),r;if((r=this._project(l[0],l[1],i,n))&&l.unshift(r[0],r[1]),(r=this._project(l[l.length-2],l[l.length-1],s,o))&&l.push(r[0],r[1]),l=this._clipFinite(e,l))for(let h=0,d=l.length,c,u=this._edgecode(l[d-2],l[d-1]);h<d;h+=2)c=u,u=this._edgecode(l[h],l[h+1]),c&&u&&(h=this._edge(e,c,u,l,h),d=l.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(l=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return l}_edge(e,t,i,n,s){for(;t!==i;){let o,l;switch(t){case 5:t=4;continue;case 4:t=6,o=this.xmax,l=this.ymin;break;case 6:t=2;continue;case 2:t=10,o=this.xmax,l=this.ymax;break;case 10:t=8;continue;case 8:t=9,o=this.xmin,l=this.ymax;break;case 9:t=1;continue;case 1:t=5,o=this.xmin,l=this.ymin;break}(n[s]!==o||n[s+1]!==l)&&this.contains(e,o,l)&&(n.splice(s,0,o,l),s+=2)}return s}_project(e,t,i,n){let s=1/0,o,l,r;if(n<0){if(t<=this.ymin)return null;(o=(this.ymin-t)/n)<s&&(r=this.ymin,l=e+(s=o)*i)}else if(n>0){if(t>=this.ymax)return null;(o=(this.ymax-t)/n)<s&&(r=this.ymax,l=e+(s=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<s&&(l=this.xmax,r=t+(s=o)*n)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<s&&(l=this.xmin,r=t+(s=o)*n)}return[l,r]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const i=(t+2)%e.length,n=(t+4)%e.length;(e[t]===e[i]&&e[i]===e[n]||e[t+1]===e[i+1]&&e[i+1]===e[n+1])&&(e.splice(i,2),t-=2)}e.length||(e=null)}return e}}const Ke=2*Math.PI,H=Math.pow;function Ye(a){return a[0]}function qe(a){return a[1]}function We(a){const{triangles:e,coords:t}=a;for(let i=0;i<e.length;i+=3){const n=2*e[i],s=2*e[i+1],o=2*e[i+2];if((t[o]-t[n])*(t[s+1]-t[n+1])-(t[s]-t[n])*(t[o+1]-t[n+1])>1e-10)return!1}return!0}function Xe(a,e,t){return[a+Math.sin(a+e)*t,e+Math.cos(a-e)*t]}class ae{static from(e,t=Ye,i=qe,n){return new ae("length"in e?Qe(e,t,i,n):Float64Array.from(Je(e,t,i,n)))}constructor(e){this._delaunator=new X(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&We(e)){this.collinear=Int32Array.from({length:t.length/2},(u,f)=>f).sort((u,f)=>t[2*u]-t[2*f]||t[2*u+1]-t[2*f+1]);const r=this.collinear[0],h=this.collinear[this.collinear.length-1],d=[t[2*r],t[2*r+1],t[2*h],t[2*h+1]],c=1e-8*Math.hypot(d[3]-d[1],d[2]-d[0]);for(let u=0,f=t.length/2;u<f;++u){const m=Xe(t[2*u],t[2*u+1],c);t[2*u]=m[0],t[2*u+1]=m[1]}this._delaunator=new X(t)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,n=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),l=this._hullIndex.fill(-1);for(let r=0,h=i.length;r<h;++r){const d=s[r%3===2?r-2:r+1];(i[r]===-1||o[d]===-1)&&(o[d]=r)}for(let r=0,h=n.length;r<h;++r)l[n[r]]=r;n.length<=2&&n.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=n[0],o[n[0]]=1,n.length===2&&(o[n[1]]=0,this.triangles[1]=n[1],this.triangles[2]=n[1]))}voronoi(e){return new He(this,e)}*neighbors(e){const{inedges:t,hull:i,_hullIndex:n,halfedges:s,triangles:o,collinear:l}=this;if(l){const c=l.indexOf(e);c>0&&(yield l[c-1]),c<l.length-1&&(yield l[c+1]);return}const r=t[e];if(r===-1)return;let h=r,d=-1;do{if(yield d=o[h],h=h%3===2?h-2:h+1,o[h]!==e)return;if(h=s[h],h===-1){const c=i[(n[e]+1)%i.length];c!==d&&(yield c);return}}while(h!==r)}find(e,t,i=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const n=i;let s;for(;(s=this._step(i,e,t))>=0&&s!==i&&s!==n;)i=s;return s}_step(e,t,i){const{inedges:n,hull:s,_hullIndex:o,halfedges:l,triangles:r,points:h}=this;if(n[e]===-1||!h.length)return(e+1)%(h.length>>1);let d=e,c=H(t-h[e*2],2)+H(i-h[e*2+1],2);const u=n[e];let f=u;do{let m=r[f];const g=H(t-h[m*2],2)+H(i-h[m*2+1],2);if(g<c&&(c=g,d=m),f=f%3===2?f-2:f+1,r[f]!==e)break;if(f=l[f],f===-1){if(f=s[(o[e]+1)%s.length],f!==m&&H(t-h[f*2],2)+H(i-h[f*2+1],2)<c)return f;break}}while(f!==u);return d}render(e){const t=e==null?e=new G:void 0,{points:i,halfedges:n,triangles:s}=this;for(let o=0,l=n.length;o<l;++o){const r=n[o];if(r<o)continue;const h=s[o]*2,d=s[r]*2;e.moveTo(i[h],i[h+1]),e.lineTo(i[d],i[d+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const i=e==null?e=new G:void 0,{points:n}=this;for(let s=0,o=n.length;s<o;s+=2){const l=n[s],r=n[s+1];e.moveTo(l+t,r),e.arc(l,r,t,0,Ke)}return i&&i.value()}renderHull(e){const t=e==null?e=new G:void 0,{hull:i,points:n}=this,s=i[0]*2,o=i.length;e.moveTo(n[s],n[s+1]);for(let l=1;l<o;++l){const r=2*i[l];e.lineTo(n[r],n[r+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new re;return this.renderHull(e),e.value()}renderTriangle(e,t){const i=t==null?t=new G:void 0,{points:n,triangles:s}=this,o=s[e*=3]*2,l=s[e+1]*2,r=s[e+2]*2;return t.moveTo(n[o],n[o+1]),t.lineTo(n[l],n[l+1]),t.lineTo(n[r],n[r+1]),t.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,i=e.length/3;t<i;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new re;return this.renderTriangle(e,t),t.value()}}function Qe(a,e,t,i){const n=a.length,s=new Float64Array(n*2);for(let o=0;o<n;++o){const l=a[o];s[o*2]=e.call(i,l,o,a),s[o*2+1]=t.call(i,l,o,a)}return s}function*Je(a,e,t,i){let n=0;for(const s of a)yield e.call(i,s,n,a),yield t.call(i,s,n,a),++n}class Ze{drawCellColors(e,t,i){const n=e.getContext("2d");if(!n)return;const{resolution:s,points:o,biomes:l}=t;n.clearRect(0,0,e.width,e.height),n.save(),n.scale(e.width/s,e.height/s);const h=ae.from(o,d=>d.x,d=>d.y).voronoi([0,0,s,s]);for(let d=0;d<o.length;d++){const c=h.cellPolygon(d);if(!c||c.length<3)continue;n.beginPath(),n.moveTo(c[0][0],c[0][1]);for(let f=1;f<c.length;f++)n.lineTo(c[f][0],c[f][1]);n.closePath();const u=i?l[d].greyscale:l[d].color;n.fillStyle=u,n.fill(),n.strokeStyle=u,n.lineWidth=.05,n.lineJoin="round",n.miterLimit=2,n.stroke()}n.restore()}}const F=a=>{const e=document.getElementById(a);if(!e)throw alert("UI init failed. Check element IDs."),new Error("UI init failed. Check element IDs.");return e};document.addEventListener("DOMContentLoaded",()=>{const a={...Ae},e=new Ve(`${Date.now()}`);let t=e.generate();const i=new Ue(t),n=new Ze,s=()=>{const x=i.generateMap(a);n.drawCellColors(h,x,a.greyScale)},o=(x=void 0)=>{const S=x??e.generate({});A.textContent=S},l=()=>{o(t),s()},r=x=>{if(!x.trim()){alert("Please enter the name of a map to load in"),t="",C.textContent="";return}t=x,i.reSeed(x),l()},h=F("map"),d=F("regen"),c=F("wavelength"),u=F("wavelengthValue"),f=F("rainfall"),m=F("rainfallValue"),g=F("seaLevel"),p=F("seaLevelValue"),_=F("shatter"),b=F("shatterValue"),v=F("edgeCurve"),E=F("edgeCurveValue"),M=F("resolution"),T=F("resolutionValue"),k=F("grayscale"),C=F("seed-input"),y=F("load-seed-btn"),A=F("map-title");c.value=String(a.wavelength),u.textContent=a.wavelength.toFixed(2),f.value=String(a.rainfall),m.textContent=a.rainfall.toFixed(2),g.value=String(a.seaLevel),p.textContent=a.seaLevel.toFixed(2),_.value=String(a.shatter),b.textContent=a.shatter.toFixed(2),v.value=String(a.edgeCurve),E.textContent=a.edgeCurve.toFixed(2),M.value=String(a.resolution),T.textContent=a.resolution.toFixed(2),k.checked=a.greyScale,c.addEventListener("input",()=>{a.wavelength=Number(c.value),u.textContent=a.wavelength.toFixed(2),s()}),f.addEventListener("input",()=>{a.rainfall=Number(f.value),m.textContent=a.rainfall.toFixed(2),s()}),g.addEventListener("input",()=>{a.seaLevel=Number(g.value),p.textContent=a.seaLevel.toFixed(2),s()}),_.addEventListener("input",()=>{a.shatter=Number(_.value),b.textContent=a.shatter.toFixed(2),s()}),v.addEventListener("input",()=>{a.edgeCurve=Number(v.value),E.textContent=a.edgeCurve.toFixed(2),s()}),M.addEventListener("input",()=>{a.resolution=Number(M.value),T.textContent=a.resolution.toFixed(2),s()}),k.addEventListener("input",()=>{a.greyScale=k.checked,s()}),d.addEventListener("click",()=>{t=e.generate(),i.reSeed(t),e.reSeed(t),l()}),l(),F("download").addEventListener("click",()=>{const x=document.createElement("a");x.download=`map-${Date.now()}.png`,x.href=h.toDataURL("image/png"),x.click()}),y.addEventListener("click",()=>{t=C.value.trim(),r(t)})});document.addEventListener("DOMContentLoaded",()=>{const a=document.getElementById("mobile-warning");if(!a)return;(/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)||window.innerWidth<768)&&(console.log("MOBILE"),a.classList.add("show"))});
